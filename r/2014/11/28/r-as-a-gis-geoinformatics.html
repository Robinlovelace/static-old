<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>R, an Integrated Statistical Programming Environment and GIS</title>
    <meta name="description" content="environmental geographer, transport modeller, energy researcher
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://robinlovelace.net/r/2014/11/28/r-as-a-gis-geoinformatics.html">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Robin Lovelace</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about">About Robin Lovelace</a>
          
        
          
        
          
          <a class="page-link" href="/book-reviews">Book reviews</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/sketches/foss4g-2014-r-abstract">FOSS4G-E Abstract</a>
          
        
          
          <a class="page-link" href="/hardware">Hardware</a>
          
        
          
          <a class="page-link" href="/ideas">Ideas</a>
          
        
          
        
          
          <a class="page-link" href="/influential-geographers">Influential geographers</a>
          
        
          
        
          
          <a class="page-link" href="/software/pandoc">Pandoc</a>
          
        
          
          <a class="page-link" href="/presentations">Presentations</a>
          
        
          
          <a class="page-link" href="/publications">Publications</a>
          
        
          
          <a class="page-link" href="/quotes">Quotes</a>
          
        
          
          <a class="page-link" href="/software">Software</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">R, an Integrated Statistical Programming Environment and GIS</h1>
    <p class="post-meta">Nov 28, 2014</p>
  </header>

  <article class="post-content">
    <p>This article was originally published in <a href="http://www.geoinformatics.com/blog/in-the-spotlight/r-an-integrated-statistical-programming-environment">Geoinformatics</a> magazine.</p>

<p><a href="http://cran.r-project.org/">R</a> is well known as a powerful, extensible and relatively fast statistical programming language and open software project with a command line interface (CLI). What is less well known is that R also has cutting edge spatial packages that allow it to behave as a fully featured Geographical Information System in the full sense of the word. In fact, some of cutting edge algorithms for image processing and spatial statistics are implemented in R before any other widely available software product (<a href="http://robinlovelace.net/r/books/2014/09/09/asdar-review.html">Bivand et al. 2013</a>). Sophisticated techniques such as geographically weighted regression and spatial interaction models can be custom built around your spatial data in R. But R also works as a general purpose GIS, with mature functions for performing all established techniques of spatial analysis such as spatial selections, buffers and clipping. What is unique about R is that all these capabilities are found in a single programme: R provides a truly integrated modelling environment.</p>

<!--more-->

<h2 id="the-advantages-and-drawbacks-of-r-as-a-gis">The advantages and drawbacks of R as a GIS</h2>

<p>Despite being able to perform the same operations as dedicated GIS software such as ArcGIS and QGIS, R is fundamentally different in the way that the user interacts with it. Not only are most operations complete by typing (e.g. you type “plot(map1)” to plot the data contained in the map1 object), the visualisation stage is different. There is no dynamic canvas which can be used to pan and zoom: instead R only produces visual or other types of output when commanded to do so, using functions such as plot.</p>

<p>Table 1: A summary of the relative merits of R compared with more traditional GIS software.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Attribute</th>
      <th style="text-align: left">Advantages of R</th>
      <th style="text-align: left">Drawbacks of R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">User interface</td>
      <td style="text-align: left">Command line interface allows rapid description of workflow and reproducibility</td>
      <td style="text-align: left">Steep learning curve (eased by RStudio)</td>
    </tr>
    <tr>
      <td style="text-align: left">Visualising data</td>
      <td style="text-align: left">Sophisticated and customisable graphics</td>
      <td style="text-align: left">No dynamic zoomable canvas</td>
    </tr>
    <tr>
      <td style="text-align: left">Selecting data</td>
      <td style="text-align: left">Concise and consistent method using square brackets (e.g. “map1[x &gt; y,]”)</td>
      <td style="text-align: left">Difficult to dynamically select objects from map</td>
    </tr>
    <tr>
      <td style="text-align: left">Manipulating data</td>
      <td style="text-align: left">Very wide range of functions through additional packages</td>
      <td style="text-align: left">Only single core processing</td>
    </tr>
    <tr>
      <td style="text-align: left">Analysing/modelling data</td>
      <td style="text-align: left">Integrated processing, analysis, and modelling framework</td>
      <td style="text-align: left">Sometimes more than one solution available</td>
    </tr>
  </tbody>
</table>

<h2 id="how-to-get-started-with-spatial-data-in-r">How to get started with spatial data in R</h2>

<p>Here is not the place to go into the details of spatial data analysis in R. Instead, we provide a number of resources that will enable rapidly getting up to speed with both R and its spatial packages. Note that when we say “packages” for R, we are referring to specific add-ons, analogous to extentions in ArcGIS and QGIS. The range of add ons is truly vast, as can be seen on the R website: http://cran.r-project.org/web/views/Spatial.html. This diversity can be daunting and it is certainly frustrating when you know that a problem can be solved in several different ways: R teaches you to think about your data and analysis carefully. The most commonly used packages for spatial analysis are probably <a href="http://cran.r-project.org/web/packages/sp/index.html"><strong>sp</strong></a> (the basis of spatial functionality in R), <strong>rgdal</strong> (for loading spatial file formats such as shapefiles) and <strong>rgeos</strong> (for spatial analysis). Each is installed and loaded in the same way: <strong>rgeos</strong>, for example, is installed and loaded by typing:</p>

<pre><code>
    install.packages(“rgeos”)
    library(rgeos)
</code></pre>

<p>An introductory tutorial on R as a GIS is the working paper “Introduction to visualising spatial data in R” (<a href="https://github.com/Robinlovelace/Creating-maps-in-R">Lovelace and Cheshire, 2014</a>). This document, along with sample code and data, is available free online. It contains links to many other spatial R resources, so is a good starting point for further explorations of R as a GIS.</p>

<h2 id="r-in-action-as-a-gis">R in action as a GIS</h2>

<p>To demonstrate where R’s flexibility comes into its own, imagine you have a large number of points that you would like to analyse. These are heavily clustered in a few area, and you would like to a) know where these clusters are; b) remove the points in these clusters and create single points in their place, which summarise the information contained in the clustered points; c) visualise the output.</p>

<p><img src="https://github.com/Robinlovelace/Creating-maps-in-R/raw/master/vignettes/figure/Aggregated_data_for_culters.png" alt="clustering" /></p>

<p>We will not actually run through all the steps needed to do this in R. Suffice to know that it is possible in R and very difficult to do in other GIS packages such as <a href="http://www.qgis.org/en/site/">QGIS</a>, ArcGIS or even <a href="http://postgis.net/">PostGIS</a> (another command line GIS that is based on the database language Postgres, a type of SQL): I was asked to tackle this problem by the Spanish GIS service SIGTE after other solutions had been tried.</p>

<p>All of the steps needed to solve the problem, including provision of example data, are provided <a href="http://robinlovelace.net/r/2014/03/21/clustering-points-R.html">online</a>. Here I provide an overview of the processes involved and some of the key functions to provide insight into the R way of thinking about spatial data.</p>

<p>First the data must be loaded and converted into yet another spatial data class. This is done using the <code class="highlighter-rouge">readOGR</code> function from the <strong>rgdal</strong> package mentioned above and then using the command <code class="highlighter-rouge">as(SpatialPoints(stations), "ppp")</code> to convert the spatial object stations into the ppp class from the spatstat package.</p>

<p>Next the data is converted into a density raster. The value of each pixel corresponds to the interpolated density of points in that area. This is visualised using the <code class="highlighter-rouge">plot</code> and <code class="highlighter-rouge">contour</code> functions to ensure that the conversion has worked properly.</p>

<p>The raster image is converted into smooth lines using the <code class="highlighter-rouge">contourLines</code>. The lines, one for each cluster zone, must then be converted into polygons using the command <code class="highlighter-rouge">gPolygonize(SLDF[5, ])</code>. <code class="highlighter-rouge">gPolygonize</code> is a very useful function from the rgeos package which automates the conversion of lines into polygons.</p>

<p>The results are plotted using the rather lengthy set of commands shown below. This results in the figure displayed above (notice the <code class="highlighter-rouge">red</code> argument creates the red fill of the zones):</p>

<pre><code>
    plot(Dens, main = "")
    plot(lnd, border = "grey", lwd = 2, add = T)
    plot(SLDF, col = terrain.colors(8), add = T)
    plot(cAg, col = "red", border = "white", add = T)
    graphics::text(coordinates(cAg) + 1000, labels = cAg$CODE)
</code></pre>

<p>Finally the points inside the cluster polygons are extracted using R’s very concise spatial subsetting syntax:</p>

<pre><code>
    sIn &lt;- stations[cAg, ]  # select the stations inside the clusters
</code></pre>

<p>The code above, translated into English, means “take all the station points within the cluster polygon called cAg and save them as a new object call sIn”.</p>

<h2 id="conclusion">Conclusion</h2>

<p>The purpose of the article has been to introduce the idea that GIS software can take many forms, including the rather unusual command line interface of the statistical programming language R. Hopefully any preconceptions about poor performance have been dispelled by the examples of converting text into spatial objects and of clustering points. Both examples would be difficult to undertake in more traditional GIS software packages. R has a steep learning curve and should probably be seen more as a powerful tool to use in harmony with other GIS packages for dealing with particularly tricky/unconventional tasks rather than a standalone GIS package in its own right form most users. R interfaces to QGIS and ArcGIS should make this easier, although this solution is not yet mature. In addition to new functionalities, R should also provide a new way of thinking about spatial data for many GIS users (Lovelace and Cheshire, 2014). Yes it has a steep learning curve, but it’s a fun curve to be on whether you are on the beginning of the ascent or in the near vertical phase of the exponential function!</p>

<h2 id="references">References</h2>

<p>Bivand, R. S., Pebesma, E. J., &amp; Gómez-Rubio, V. (2013). Applied spatial data analysis with R (Vol. 747248717). Springer.</p>

<p>Lovelace, R., &amp; Cheshire, J. (2014). Introduction to visualising spatial data in R. National Centre for Research Methods, 1403. Retrieved from http://eprints.ncrm.ac.uk/3295/</p>

<p>Wickham, H. (2014). Tidy data. The Journal of Statistical Software, 14(5). Retrieved from http://vita.had.co.nz/papers/tidy-data.html</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Robin Lovelace</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>Robin Lovelace</li>
          <li><a href="mailto:rob00x@gmail.com">rob00x@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/robinlovelace">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">robinlovelace</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/robinlovelace">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">robinlovelace</span>
            </a>
          </li>
          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">environmental geographer, transport modeller, energy researcher
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
